#include "main.h"

#define SWITCH_DELAY 500000

void TIM2_IRQHandler(void)
{
   static int flag = 1;
   if(TIM_GetITStatus(TIM2, TIM_IT_Update) != RESET)
   {    if (flag == 1)
        {
            GPIO_ResetBits(GPIOA, GPIO_Pin_8);
	    GPIO_SetBits(GPIOA, GPIO_Pin_10);
            flag = -flag;
        }
        else
   	{
	    GPIO_ResetBits(GPIOA, GPIO_Pin_10);
            GPIO_SetBits(GPIOA, GPIO_Pin_8);
	    flag = -flag;
	}
	TIM_ClearITPendingBit(TIM2, TIM_IT_Update);
    }
}


int main (void)
{


  RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2 , ENABLE);

  tim_struct.TIM_Period = 2000 - 1;
  tim_struct.TIM_Prescaler = 42000 - 1;
  tim_struct.TIM_ClockDivision = 0;
  tim_struct.TIM_CounterMode = TIM_CounterMode_Up;
  TIM_ITConfig(TIM2, TIM_IT_Update, ENABLE);
  TIM_TimeBaseInit(TIM2, &tim_struct);
  TIM_Cmd(TIM2, ENABLE);*/

  /*Init interrupt (in programm)*/
  /*nvic_struct.NVIC_IRQChannel= TIM2_IRQn;
  nvic_struct.NVIC_IRQChannelPreemptionPriority= 0;
  nvic_struct.NVIC_IRQChannelSubPriority= 1;
  nvic_struct.NVIC_IRQChannelCmd= ENABLE;
  NVIC_Init(&nvic_struct);
}



//http://stm32.kosyak.info/doc/group___t_i_m___private___functions.html#gab3a6031f187cb8af62eb09a67b4fd2ad